<ng-container *ngIf="!panelMode; else panel">
  <div class="auth-page">
    <div class="auth-bg" aria-hidden="true"></div>

    <div class="auth-card">
      <div class="auth-header">
        <div class="brand">
          <div class="logo">MP</div>
          <div class="brand-text">
            <h1>Recuperar contraseña</h1>
            <p>Te enviaremos un enlace si tu email está registrado</p>
          </div>
        </div>
      </div>

      <form class="auth-form" [formGroup]="form" (ngSubmit)="submit()" *ngIf="!sent" novalidate>
        <div class="form-control" [class.invalid]="form.controls.email.invalid && form.controls.email.touched">
          <label for="email">Email</label>
          <div class="input-wrapper">
            <i class="pi pi-envelope"></i>
            <input id="email" type="email" formControlName="email" placeholder="tu@email.com" />
          </div>
          <small class="hint" *ngIf="form.controls.email.invalid && form.controls.email.touched">Ingresa un email válido</small>
        </div>

        <button class="btn-primary" type="submit" [disabled]="loading">
          <span class="btn-content">
            <i class="pi pi-send"></i>
            {{ loading ? 'Enviando…' : 'Enviar enlace' }}
          </span>
        </button>

        <div class="auth-footer">
          <a routerLink="/login">Volver al inicio de sesión</a>
        </div>
      </form>

      <div class="sent" *ngIf="sent">
        <i class="pi pi-check-circle"></i>
        <h3>Revisa tu correo</h3>
        <p>Si existe una cuenta con ese email, recibirás un enlace para restablecer tu contraseña.</p>
        <button class="btn-primary" type="button" (click)="goToLogin()">
          <span class="btn-content">
            <i class="pi pi-sign-in"></i>
            Ir a iniciar sesión
          </span>
        </button>
      </div>
    </div>
  </div>
</ng-container>

<ng-template #panel>
  <div class="auth-container">
    <div class="auth-header" style="margin-bottom: 16px;">
      <div class="brand">
        <div class="logo">MP</div>
        <div class="brand-text">
          <h1 style="margin: 0; font-size: 1.25rem;">Recuperar contraseña</h1>
          <p style="margin: 0; color: var(--text-secondary, #6b7280);">Te enviaremos un enlace si tu email está registrado</p>
        </div>
      </div>
    </div>

    <form class="auth-form" [formGroup]="form" (ngSubmit)="submit()" *ngIf="!sent" novalidate>
      <div class="form-control" [class.invalid]="form.controls.email.invalid && form.controls.email.touched">
        <label for="email">Email</label>
        <div class="input-wrapper">
          <i class="pi pi-envelope"></i>
          <input id="email" type="email" formControlName="email" placeholder="tu@email.com" />
        </div>
        <small class="hint" *ngIf="form.controls.email.invalid && form.controls.email.touched">Ingresa un email válido</small>
      </div>

      <button class="btn-primary" type="submit" [disabled]="loading">
        <span class="btn-content">
          <i class="pi pi-send"></i>
          {{ loading ? 'Enviando…' : 'Enviar enlace' }}
        </span>
      </button>
    </form>

    <div class="sent" *ngIf="sent">
      <i class="pi pi-check-circle"></i>
      <h3>Revisa tu correo</h3>
      <p>Si existe una cuenta con ese email, recibirás un enlace para restablecer tu contraseña.</p>
      <button class="btn-primary" type="button" (click)="goToLogin()">
        <span class="btn-content">
          <i class="pi pi-sign-in"></i>
          Ir a iniciar sesión
        </span>
      </button>
    </div>
  </div>
</ng-template>
